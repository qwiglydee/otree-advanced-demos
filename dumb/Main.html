{{ block content }}

<header>
    <h3>The header</h3>
    <p>Page reloaded <b ot-text="vars.counter"></b> times</p>
</header>

<main ot-class="vars.fading">
    <h3>The main section</h3>

    <div class="d-flex flex-row gap-1">
        <button type="button" class="btn btn-primary m-1" ot-input name="switch" value="1">1</button>
        <button type="button" class="btn btn-primary m-1" ot-input name="switch" value="2">2</button>
        <button type="button" class="btn btn-primary m-1" ot-input name="switch" value="3">3</button>
    </div>

    <section ot-display="section-1" class="rounded border m-2 p-3" hidden>
        <h4>Section 1</h4>
        <p>Content 1</p>
        <p>Content 2</p>
        <p>Content 3</p>
    </section>

    <section ot-display="section-2" class="rounded border m-2 p-3"  hidden>
        <h4>Section 2</h4>
        <p>Content 1</p>
        <p>Content 2</p>
        <p>Content 3</p>
        <p>Content 4</p>
        <p>Content 5</p>
    </section>
</main>

<footer>
    <h3>The footer</h3>
    <p>Some content</p>
    <div class="flex-fill"></div>
    <button ot-display="next" type="button" class="btn btn-primary" ot-input name="next">Next</button>
    <div ot-display="spinner" class="spinner-ellipsis"><i></i><i></i><i></i></div>
</footer>

{{ endblock }}

{{ block styles }}
<link rel="stylesheet" href="{{ static 'fullscreen.css' }}">
<link rel="stylesheet" href="{{ static 'enhancements.css' }}">
<link rel="stylesheet" href="{{ static 'xfade.css' }}">
<link rel="stylesheet" href="{{ static 'progress2.css' }}">
<link rel="stylesheet" href="{{ static 'spinner-pulse.css' }}">
{{ endblock }}

{{ block scripts }}
<script src="{{ static 'otree-front-1.5.b2.js' }}"></script>

<script>
    ot.onStartPage(function() {
        vars.counter = 0;
        vars.fading = "hidden";
        ot.hideDisplays();
        nextIter();
    });

    function nextIter() {
        vars.counter += 1;
        vars.fading = "fadein";
        ot.switchDisplays({ only: 'next' });
    }

    ot.onInput('next', function() {
        ot.disableInputs();
        ot.switchDisplays({ off: 'next', on: 'spinner'});

        ot.delay(1000 - 200, function() {
            vars.fading = "fadeout";
        });
        ot.delay(1000, function() {
            nextIter();
        });
    });

    ot.onInput('switch', function(i) {
        if (i == 3) {
            ot.switchDisplays({ on: ['section-1', 'section-2'] })
        } else {
            ot.switchDisplays({ off: ['section-1', 'section-2'], on: `section-${i}` })
        }
    });
</script>
{{ endblock }}