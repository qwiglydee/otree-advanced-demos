{{ block styles }}
<link href="{{ static 'fullscreen.css' }}" rel="stylesheet">
<link href="{{ static 'progress2.css' }}" rel="stylesheet">
<link href="{{ static 'enhancements.css' }}" rel="stylesheet">
<style>
    main {
        flex-flow: row wrap;
        justify-content: center;
    }
    .slider {
        width: 300px;
        height: 32px;
        border-radius: 16px;
        padding: 0 8px;
        background: hsl(216, 17%, 98%);
        border: 1px solid rgba(0, 0, 0, 0.125);
    }

    .slider.is-valid {
        background: hsl(151.2, 71.43%, 93.14%);
    }
</style>
{{ endblock }}

{{ block content }}

<header>
    <!-- indicates number of correct sliders -->
    <my-progress class="w-100" max="vars.progress.total" ticks="1" value="vars.progress.solved">
    </my-progress>
    <div class="alert alert-info m-2">Total score: <b ot-text="vars.progress.score"></b></div>
</header>

<main>
    {{ for slider in sliders }}
    <input type="range" class="slider form-range my-1" ot-class="vars.classes.{{slider.name}}" min="-10" max="+10"
        name="{{slider.name}}" value="{{slider.value}}"
        style="margin-left:{{slider.margins.l}}px; margin-right:{{slider.margins.r}}px" ot-input>
    {{ endfor }}
</main>

<footer>
    <p>Put all sliders into middle position.</p>
</footer>

{{ endblock }}

{{ block scripts }}

<script src="{{ static 'otree-front-1.3.b1.js' }}"></script>
<script src="{{ static 'progress2.js' }}"></script>

<script>
    "use strict";

    ot.onStartPage(function () {
        vars.classes = {};
        vars.progress = js_vars.progress;
        ot.enableInputs();
    });

    ot.onInput(function (name, value) {
        value = parseInt(value);
        ot.sendLive("move", { name, value });
    });

    ot.onLive('feedback', function (data) {
        if (data.solved) {
            vars.classes[data.name] = "is-valid";
        } else {
            vars.classes[data.name] = null;
        }
    });

    ot.onLive('progress', function (data) {
        Object.assign(vars.progress, data);
        if (data.terminated) {
            ot.completePage();
        }
    });
</script>

{{ endblock }}